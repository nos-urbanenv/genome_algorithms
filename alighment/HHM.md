# 隠れマルコフモデルによる配列情報解析(に関する備忘録的まとめ)
隠れマルコフモデルに関する解説の書籍は多数出回っているので、いまさら何を書くべきだろうか？

隠れマルコフモデル*M*は以下のように定義される。
$M = {S,\Sigma, A, E}$
$S = {s_0, s_1, ..., s_{m-1}}$
$A = a_{ij}$
$B = {e(s_i, c_k)=e_i(c_k)=e_{ik}=e(c_k|s_i)}$

配列xが与えられたとき、最も確からしい状態列$\pi$を推定するためのアルゴリズムをViterbiアルゴリズムと呼ぶ。
状態列推定のためにViterbi変数vを定義する。
Viterbi変数は以下のように定義される。

Viterbi変数v_k(t)
$v_k(t) = max_{\pi|\pi_t=s_k}P(x_1...x_t,\pi_1...\pi_t)$
この数式の意味するところは、「時刻tまでに観測された部分列$x_t=x_1...x_t$と時刻tまでの部分状態列$\pi_t=s_1...s_t$の同時確率で、
\pi_t=s_kである場合の確率」

ここで、「同時確率分布」に関して、数理統計学の観点から定義を明確にする必要がある。
数理統計学の知識がない読者は読み飛ばして頂いて構わない。



そのうえで、Viterbiアルゴリズムは定義以下のように表される。
最大確率の状態列を知るために、再帰処理の過程でトレースバック・ポインターptr_t(l)を記録しながら

Initialization $v_0(0)=1, v_0(k)=0 for k>0$
Recursion 
$v_l(i)=e_l(x_i)max_k()$
$$
$$


以上のアルゴリズムをPythonを使って実装してみよう。
入力配列$x$は配列の形で与えられ、